import requests
import re
import os
import pandas as pd
import pprint as pp
import argparse
from pymongo import MongoClient, collection
from random import randint
from time import sleep
from dotenv import load_dotenv
from datetime import datetime
from datetime import timedelta

def main():
    load_dotenv()

    parser = argparse.ArgumentParser(description='Description of the script')
    parser.add_argument('-mode','--mode', help='insert or update database', required=True)
    parser.add_argument('-collection','--collection', help='[all/collection_n]', required=True)
    args = vars(parser.parse_args())

    collection = args['collection']

    # Links to search
    df = pd.read_csv('URLs/retweeted_urls_rph_BRA.csv',nrows=2500)
    # print(df.head())

    if collection != 'all':
        df = df[df['collection_name'] == collection]

    collectionsDone = [
        "collection_0001",
        "collection_0002",
        "collection_0003",
        "collection_0004",
        "collection_0005",
        "collection_0006",
        "collection_0007",
        "collection_0008",
        "collection_0009",
        "collection_0010",
        "collection_0011",
        "collection_0012",
        "collection_0013",
        "collection_0014",
        "collection_0015",
        "collection_0016",
        "collection_0017",
        "collection_0018",
        "collection_0019",
        "collection_0020",
        "collection_0021",
        "collection_0022",
        "collection_0023",
        "collection_0024",
        "collection_0025",
        "collection_0026",
        "collection_0027",
        "collection_0028",
        "collection_0029",
        "collection_0030",
        "collection_0031",
        "collection_0032",
        "collection_0033",
        "collection_0034",
        "collection_0035",
        "collection_0036",
        "collection_0037",
        "collection_0038",
        "collection_0039",
        "collection_0040",
        "collection_0041",
        "collection_0042",
        "collection_0043",
        "collection_0044",
        "collection_0045",
        "collection_0046",
        "collection_0047",
        "collection_0048",
        "collection_0049",
        "collection_0050",
        "collection_0051",
        "collection_0052",
        "collection_0053",
        "collection_0054",
        "collection_0055",
        "collection_0056",
        "collection_0057",
        "collection_0058",
        "collection_0059",
        "collection_0060",
        "collection_0061",
        "collection_0062",
        "collection_0063",
        "collection_0064",
        "collection_0065",
        "collection_0066",
        "collection_0067",
        "collection_0068",
        "collection_0069",
        "collection_0070",
        "collection_0071",
        "collection_0072",
        "collection_0073",
        "collection_0074",
        "collection_0075",
        "collection_0076",
        "collection_0077",
        "collection_0078",
        "collection_0079",
        "collection_0080",
        "collection_0081",
        "collection_0082",
        "collection_0083",
        "collection_0084",
        "collection_0085",
        "collection_0086",
        "collection_0087",
        "collection_0088",
        "collection_0089",
        "collection_0090",
        "collection_0091",
        "collection_0092",
        "collection_0093",
        "collection_0094",
        "collection_0095",
        "collection_0096",
        "collection_0097",
        "collection_0098",
        "collection_0099",
        "collection_0100",
        "collection_0101",
        "collection_0102",
        "collection_0103",
        "collection_0104",
        "collection_0105",
        "collection_0106",
        "collection_0107",
        "collection_0108",
        "collection_0109",
        "collection_0110",
        "collection_0111",
        "collection_0112",
        "collection_0113",
        "collection_0114",
        "collection_0115",
        "collection_0116",
        "collection_0117",
        "collection_0118",
        "collection_0119",
        "collection_0120",
        "collection_0121",
        "collection_0122",
        "collection_0123",
        "collection_0124",
        "collection_0125",
        "collection_0126",
        "collection_0127",
        "collection_0128",
        "collection_0129",
        "collection_0130",
        "collection_0131",
        "collection_0132",
        "collection_0133",
        "collection_0134",
        "collection_0135",
        "collection_0136",
        "collection_0137",
        "collection_0138",
        "collection_0139",
        "collection_0140",
        "collection_0141",
        "collection_0142",
        "collection_0143",
        "collection_0144",
        "collection_0145",
        "collection_0146",
        "collection_0147",
        "collection_0148",
        "collection_0149",
        "collection_0150",
        "collection_0151",
        "collection_0152",
        "collection_0153",
        "collection_0154",
        "collection_0155",
        "collection_0156",
        "collection_0157",
        "collection_0158",
        "collection_0159",
        "collection_0160",
        "collection_0161",
        "collection_0162",
        "collection_0163",
        "collection_0164",
        "collection_0165",
        "collection_0166",
        "collection_0167",
        "collection_0168",
        "collection_0169",
        "collection_0170",
        "collection_0171",
        "collection_0172",
        "collection_0173",
        "collection_0174",
        "collection_0175",
        "collection_0176",
        "collection_0177",
        "collection_0178",
        "collection_0179",
        "collection_0180",
        "collection_0181",
        "collection_0182",
        "collection_0183",
        "collection_0184",
        "collection_0185",
        "collection_0186",
        "collection_0187",
        "collection_0188",
        "collection_0189",
        "collection_0190",
        "collection_0191",
        "collection_0192",
        "collection_0193",
        "collection_0194",
        "collection_0195",
        "collection_0196",
        "collection_0197",
        "collection_0198",
        "collection_0199",
        "collection_0200",
        "collection_0201",
        "collection_0202",
        "collection_0203",
        "collection_0204",
        "collection_0205",
        "collection_0206",
        "collection_0207",
        "collection_0208",
        "collection_0209",
        "collection_0210",
        "collection_0211",
        "collection_0212",
        "collection_0213",
        "collection_0214",
        "collection_0215",
        "collection_0216",
        "collection_0217",
        "collection_0218",
        "collection_0219",
        "collection_0220",
        "collection_0221",
        "collection_0222",
        "collection_0223",
        "collection_0224",
        "collection_0225",
        "collection_0226",
        "collection_0227",
        "collection_0228",
        "collection_0229",
        "collection_0230",
        "collection_0231",
        "collection_0232",
        "collection_0233",
        "collection_0234",
        "collection_0235",
        "collection_0236",
        "collection_0237",
        "collection_0238",
        "collection_0239",
        "collection_0240",
        "collection_0241",
        "collection_0242",
        "collection_0243",
        "collection_0244",
        "collection_0245",
        "collection_0246",
        "collection_0247",
        "collection_0248",
        "collection_0249",
        "collection_0250",
        "collection_0251",
        "collection_0252",
        "collection_0253",
        "collection_0254",
        "collection_0255",
        "collection_0256",
        "collection_0257",
        "collection_0258",
        "collection_0259",
        "collection_0260",
        "collection_0261",
        "collection_0262",
        "collection_0263",
        "collection_0264",
        "collection_0265",
        "collection_0266",
        "collection_0267",
        "collection_0268",
        "collection_0269",
        "collection_0270",
        "collection_0271",
        "collection_0272",
        "collection_0273",
        "collection_0274",
        "collection_0275",
        "collection_0276",
        "collection_0277",
        "collection_0278",
        "collection_0279",
        "collection_0280",
        "collection_0281",
        "collection_0282",
        "collection_0283",
        "collection_0284",
        "collection_0285",
        "collection_0286",
        "collection_0287",
        "collection_0288",
        "collection_0289",
        "collection_0290",
        "collection_0291",
        "collection_0292",
        "collection_0293",
        "collection_0294",
        "collection_0295",
        "collection_0296",
        "collection_0297",
        "collection_0298",
        "collection_0299",
        "collection_0300",
        "collection_0301",
        "collection_0302",
        "collection_0303",
        "collection_0304",
        "collection_0305",
        "collection_0306",
        "collection_0307",
        "collection_0308",
        "collection_0309",
        "collection_0310",
        "collection_0311",
        "collection_0312",
        "collection_0313",
        "collection_0314",
        "collection_0315",
        "collection_0316",
        "collection_0317",
        "collection_0318",
        "collection_0319",
        "collection_0320",
        "collection_0321",
        "collection_0322",
        "collection_0323",
        "collection_0324",
        "collection_0325",
        "collection_0326",
        "collection_0327",
        "collection_0328",
        "collection_0329",
        "collection_0330",
        "collection_0331",
        "collection_0332",
        "collection_0333",
        "collection_0334",
        "collection_0335",
        "collection_0336",
        "collection_0337",
        "collection_0338",
        "collection_0339",
        "collection_0340",
        "collection_0341",
        "collection_0342",
        "collection_0343",
        "collection_0344",
        "collection_0345",
        "collection_0346",
        "collection_0347",
        "collection_0348",
        "collection_0349",
        "collection_0350",
        "collection_0351",
        "collection_0352",
        "collection_0353",
        "collection_0354",
        "collection_0355",
        "collection_0356",
        "collection_0357",
        "collection_0358",
        "collection_0359",
        "collection_0360",
        "collection_0361",
        "collection_0362",
        "collection_0363",
        "collection_0364",
        "collection_0365",
        "collection_0366",
        "collection_0367",
        "collection_0368",
        "collection_0369",
        "collection_0370",
        "collection_0371",
        "collection_0372",
        "collection_0373",
        "collection_0374",
        "collection_0375",
        "collection_0376",
        "collection_0377",
        "collection_0378",
        "collection_0379",
        "collection_0380",
        "collection_0381",
        "collection_0382",
        "collection_0383",
        "collection_0384",
        "collection_0385",
        "collection_0386",
        "collection_0387",
        "collection_0388",
        "collection_0389",
        "collection_0390",
        "collection_0391",
        "collection_0392",
        "collection_0393",
        "collection_0394",
        "collection_0395",
        "collection_0396",
        "collection_0397",
        "collection_0398",
        "collection_0399",
        "collection_0400",
        "collection_0401",
        "collection_0402",
        "collection_0403",
        "collection_0404",
        "collection_0405",
        "collection_0406",
        "collection_0407",
        "collection_0408",
        "collection_0409",
        "collection_0410",
        "collection_0411",
        "collection_0412",
        "collection_0413",
        "collection_0414",
        "collection_0415",
        "collection_0416",
        "collection_0417",
        "collection_0418",
        "collection_0419",
        "collection_0420",
        "collection_0421",
        "collection_0422",
        "collection_0423",
        "collection_0424",
        "collection_0425",
        "collection_0426",
        "collection_0427",
        "collection_0428",
        "collection_0429",
        "collection_0430",
        "collection_0431",
        "collection_0432",
        "collection_0433",
        "collection_0434",
        "collection_0435",
        "collection_0436",
        "collection_0437",
        "collection_0438",
        "collection_0439",
        "collection_0440",
        "collection_0441",
        "collection_0442",
        "collection_0443",
        "collection_0444",
        "collection_0445",
        "collection_0446",
        "collection_0447",
        "collection_0448",
        "collection_0449",
        "collection_0450",
        "collection_0451",
        "collection_0452",
        "collection_0453",
        "collection_0454",
        "collection_0455",
        "collection_0456",
        "collection_0457",
        "collection_0458",
        "collection_0459",
        "collection_0460",
        "collection_0461",
        "collection_0462",
        "collection_0463",
        "collection_0464",
        "collection_0465",
        "collection_0466",
        "collection_0467",
        "collection_0468",
        "collection_0469",
        "collection_0470",
        "collection_0471",
        "collection_0472",
        "collection_0473",
        "collection_0474",
        "collection_0475",
        "collection_0476",
        "collection_0477",
        "collection_0478",
        "collection_0479",
        "collection_0480",
        "collection_0481",
        "collection_0482",
        "collection_0483",
        "collection_0484",
        "collection_0485",
        "collection_0486",
        "collection_0487",
        "collection_0488",
        "collection_0489",
        "collection_0490",
        "collection_0491",
        "collection_0492",
        "collection_0493",
        "collection_0494",
        "collection_0495",
        "collection_0496",
        "collection_0497",
        "collection_0498",
        "collection_0499",
        "collection_0500",
        "collection_0501",
        "collection_0502",
        "collection_0503",
        "collection_0504",
        "collection_0505",
        "collection_0506",
        "collection_0507",
        "collection_0508",
        "collection_0509",
        "collection_0510",
        "collection_0511",
        "collection_0512",
        "collection_0513",
        "collection_0514",
        "collection_0515",
        "collection_0516",
        "collection_0517",
        "collection_0518",
        "collection_0519",
        "collection_0520",
        "collection_0521",
        "collection_0522",
        "collection_0523",
        "collection_0524",
        "collection_0525",
        "collection_0526",
        "collection_0527",
        "collection_0528",
        "collection_0529",
        "collection_0530",
        "collection_0531",
        "collection_0532",
        "collection_0533",
        "collection_0534",
        "collection_0535",
        "collection_0536",
        "collection_0537",
        "collection_0538",
        "collection_0539",
        "collection_0540",
        "collection_0541",
        "collection_0542",
        "collection_0543",
        "collection_0544",
        "collection_0545",
        "collection_0546",
        "collection_0547",
        "collection_0548",
        "collection_0549",
        "collection_0550",
        "collection_0551",
        "collection_0552",
        "collection_0553",
        "collection_0554",
        "collection_0555",
        "collection_0556",
        "collection_0557",
        "collection_0558",
        "collection_0559",
        "collection_0560",
        "collection_0561",
        "collection_0562",
        "collection_0563",
        "collection_0564",
        "collection_0565",
        "collection_0566",
        "collection_0567",
        "collection_0568",
        "collection_0569",
        "collection_0570",
        "collection_0571",
        "collection_0572",
        "collection_0573",
        "collection_0574",
        "collection_0575",
        "collection_0576",
        "collection_0577",
        "collection_0578",
        "collection_0579",
        "collection_0580",
        "collection_0581",
        "collection_0582",
        "collection_0583",
        "collection_0584",
        "collection_0585",
        "collection_0586",
        "collection_0587",
        "collection_0588",
        "collection_0589",
        "collection_0590",
        "collection_0591",
        "collection_0592",
        "collection_0593",
        "collection_0594",
        "collection_0595",
        "collection_0596",
        "collection_0597",
        "collection_0598",
        "collection_0599",
        "collection_0600",
        "collection_0601",
        "collection_0602",
        "collection_0603",
        "collection_0604",
        "collection_0605",
        "collection_0606",
        "collection_0607",
        "collection_0608",
        "collection_0609",
        "collection_0610",
        "collection_0611",
        "collection_0612",
        "collection_0613",
        "collection_0614",
        "collection_0615",
        "collection_0616",
        "collection_0617",
        "collection_0618",
        "collection_0619",
        "collection_0620",
        "collection_0621",
        "collection_0622",
        "collection_0623",
        "collection_0624",
        "collection_0625",
        "collection_0626",
        "collection_0627",
        "collection_0628",
        "collection_0629",
        "collection_0630",
        "collection_0631",
        "collection_0632",
        "collection_0633",
        "collection_0634",
        "collection_0635",
        "collection_0636",
        "collection_0637",
        "collection_0638",
        "collection_0639",
        "collection_0640",
        "collection_0641",
        "collection_0642",
        "collection_0643",
        "collection_0644",
        "collection_0645",
        "collection_0646",
        "collection_0647",
        "collection_0648",
        "collection_0649",
        "collection_0650",
        "collection_0651",
        "collection_0652",
        "collection_0653",
        "collection_0654",
        "collection_0655",
        "collection_0656",
        "collection_0657",
        "collection_0658",
        "collection_0659",
        "collection_0660",
        "collection_0661",
        "collection_0662",
        "collection_0663",
        "collection_0664",
        "collection_0665",
        "collection_0666",
        "collection_0667",
        "collection_0668",
        "collection_0669",
        "collection_0670",
        "collection_0671",
        "collection_0672",
        "collection_0673",
        "collection_0674",
        "collection_0675",
        "collection_0676",
        "collection_0677",
        "collection_0678",
        "collection_0679",
        "collection_0680",
        "collection_0681",
        "collection_0682",
        "collection_0683",
        "collection_0684",
        "collection_0685",
        "collection_0686",
        "collection_0687",
        "collection_0688",
        "collection_0689",
        "collection_0690",
        "collection_0691",
        "collection_0692",
        "collection_0693",
        "collection_0694",
        "collection_0695",
        "collection_0696",
        "collection_0697",
        "collection_0698",
        "collection_0699",
        "collection_0700",
        "collection_0701",
        "collection_0702",
        "collection_0703",
        "collection_0704",
        "collection_0705",
        "collection_0706",
        "collection_0707",
        "collection_0708",
        "collection_0709",
        "collection_0710",
        "collection_0711",
        "collection_0712",
        "collection_0713",
        "collection_0714",
        "collection_0715",
        "collection_0716",
        "collection_0717",
        "collection_0718",
        "collection_0719",
        "collection_0720",
        "collection_0721",
        "collection_0722",
        "collection_0723",
        "collection_0724",
        "collection_0725",
        "collection_0726",
        "collection_0727",
        "collection_0728",
        "collection_0729",
        "collection_0730",
        "collection_0731",
        "collection_0732",
        "collection_0733",
        "collection_0734",
        "collection_0735",
        "collection_0736",
        "collection_0737",
        "collection_0738",
        "collection_0739",
        "collection_0740",
        "collection_0741",
        "collection_0742",
        "collection_0743",
        "collection_0744",
        "collection_0745",
        "collection_0746",
        "collection_0747",
        "collection_0748",
        "collection_0749",
        "collection_0750",
        "collection_0751",
        "collection_0752",
        "collection_0753",
        "collection_0754",
        "collection_0755",
        "collection_0756",
        "collection_0757",
        "collection_0758",
        "collection_0759",
        "collection_0760",
        "collection_0761",
        "collection_0762",
        "collection_0763",
        "collection_0764",
        "collection_0765",
        "collection_0766",
        "collection_0767",
        "collection_0768",
        "collection_0769",
        "collection_0770",
        "collection_0771",
        "collection_0772",
        "collection_0773",
        "collection_0774",
        "collection_0775",
        "collection_0776",
        "collection_0777",
        "collection_0778",
        "collection_0779",
        "collection_0780",
        "collection_0781",
        "collection_0782",
        "collection_0783",
        "collection_0784",
        "collection_0785",
        "collection_0786",
        "collection_0787",
        "collection_0788",
        "collection_0789",
        "collection_0790",
        "collection_0791",
        "collection_0792",
        "collection_0793",
        "collection_0794",
        "collection_0795",
        "collection_0796",
        "collection_0797",
        "collection_0798",
        "collection_0799",
        "collection_0800",
        "collection_0801",
        "collection_0802",
        "collection_0803",
        "collection_0804",
        "collection_0805",
        "collection_0806",
        "collection_0807",
        "collection_0808",
        "collection_0809",
        "collection_0810",
        "collection_0811",
        "collection_0812",
        "collection_0813",
        "collection_0814",
        "collection_0815",
        "collection_0816",
        "collection_0817",
        "collection_0818",
        "collection_0819",
        "collection_0820",
        "collection_0821",
        "collection_0822",
        "collection_0823",
        "collection_0824",
        "collection_0825",
        "collection_0826",
        "collection_0827",
        "collection_0828",
        "collection_0829",
        "collection_0830",
        "collection_0831",
        "collection_0832",
        "collection_0833",
        "collection_0834",
        "collection_0835",
        "collection_0836",
        "collection_0837",
        "collection_0838",
        "collection_0839",
        "collection_0840",
        "collection_0841",
        "collection_0842",
        "collection_0843",
        "collection_0844",
        "collection_0845",
        "collection_0846",
        "collection_0847",
        "collection_0848",
        "collection_0849",
        "collection_0850",
        "collection_0851",
        "collection_0852",
        "collection_0853",
        "collection_0854",
        "collection_0855",
        "collection_0856",
        "collection_0857",
        "collection_0858",
        "collection_0859",
        "collection_0860",
        "collection_0861",
        "collection_0862",
        "collection_0863",
        "collection_0864",
        "collection_0865",
        "collection_0866",
        "collection_0867",
        "collection_0868",
        "collection_0869",
        "collection_0870",
        "collection_0871",
        "collection_0872",
        "collection_0873",
        "collection_0874",
        "collection_0875",
        "collection_0876",
        "collection_0877",
        "collection_0878",
        "collection_0879",
        "collection_0880",
        "collection_0881",
        "collection_0882",
        "collection_0883",
        "collection_0884",
        "collection_0885",
        "collection_0886",
        "collection_0887",
        "collection_0888",
        "collection_0889",
        "collection_0890",
        "collection_0891",
        "collection_0892",
        "collection_0893",
        "collection_0894",
        "collection_0895",
        "collection_0896",
        "collection_0897",
        "collection_0898",
        "collection_0899",
        "collection_0900",
        "collection_0901",
        "collection_0902",
        "collection_0903",
        "collection_0904",
        "collection_0905",
        "collection_0906",
        "collection_0907",
        "collection_0908",
        "collection_0909",
        "collection_0910",
        "collection_0911",
        "collection_0912",
        "collection_0913",
        "collection_0914",
        "collection_0915",
        "collection_0916",
        "collection_0917",
        "collection_0918",
        "collection_0919",
        "collection_0920",
        "collection_0921",
        "collection_0922",
        "collection_0923",
        "collection_0924",
        "collection_0925",
        "collection_0926",
        "collection_0927",
        "collection_0928",
        "collection_0929",
        "collection_0930",
        "collection_0931",
        "collection_0932",
        "collection_0933",
        "collection_0934",
        "collection_0935",
        "collection_0936",
        "collection_0937",
        "collection_0938",
        "collection_0939",
        "collection_0940",
        "collection_0941",
        "collection_0942",
        "collection_0943",
        "collection_0944",
        "collection_0945",
        "collection_0946",
        "collection_0947",
        "collection_0948",
        "collection_0949",
        "collection_0950",
        "collection_0951",
        "collection_0952",
        "collection_0953",
        "collection_0954",
        "collection_0955",
        "collection_0956",
        "collection_0957",
        "collection_0958",
        "collection_0959",
        "collection_0960",
        "collection_0961",
        "collection_0962",
        "collection_0963",
        "collection_0964",
        "collection_0965",
        "collection_0966",
        "collection_0967",
        "collection_0968",
        "collection_0969",
        "collection_0970",
        "collection_0971",
        "collection_0972",
        "collection_0973",
        "collection_0974",
        "collection_0975",
        "collection_0976",
        "collection_0977",
        "collection_0978",
        "collection_0979",
        "collection_0980",
        "collection_0981",
        "collection_0982",
        "collection_0983",
        "collection_0984",
        "collection_0985",
        "collection_0986",
        "collection_0987",
        "collection_0988",
        "collection_0989",
        "collection_0990",
        "collection_0991",
        "collection_0992",
        "collection_0993",
        "collection_0994",
        "collection_0995",
        "collection_0996",
        "collection_0997",
        "collection_0998",
        "collection_0999",
        "collection_1000",
        "collection_1001",
        "collection_1002",
        "collection_1003",
        "collection_1004",
        "collection_1005",
        "collection_1006",
        "collection_1007",
        "collection_1008",
        "collection_1009",
        "collection_1010",
        "collection_1011",
        "collection_1012",
        "collection_1013",
        "collection_1014",
        "collection_1015",
        "collection_1016",
        "collection_1017",
        "collection_1018",
        "collection_1019",
        "collection_1020",
        "collection_1021",
        "collection_1022",
        "collection_1023",
        "collection_1024",
        "collection_1025",
        "collection_1026",
        "collection_1027",
        "collection_1028",
        "collection_1029",
        "collection_1030",
        "collection_1031",
        "collection_1032",
        "collection_1033",
        "collection_1034",
        "collection_1035",
        "collection_1036",
        "collection_1037",
        "collection_1038",
        "collection_1039",
        "collection_1040",
        "collection_1041",
        "collection_1042",
        "collection_1043",
        "collection_1044",
        "collection_1045",
        "collection_1046",
        "collection_1047",
        "collection_1048",
        "collection_1049",
        "collection_1050",
        "collection_1051",
        "collection_1052",
        "collection_1053",
        "collection_1054",
        "collection_1055",
        "collection_1056",
        "collection_1057",
        "collection_1058",
        "collection_1059",
        "collection_1060",
        "collection_1061",
        "collection_1062",
        "collection_1063",
        "collection_1064",
        "collection_1065",
        "collection_1066",
        "collection_1067",
        "collection_1068",
        "collection_1069",
        "collection_1070",
        "collection_1071",
        "collection_1072",
        "collection_1073",
        "collection_1074",
        "collection_1075",
        "collection_1076",
        "collection_1077",
        "collection_1078",
        "collection_1079",
        "collection_1080",
        "collection_1081",
        "collection_1082",
        "collection_1083",
        "collection_1084",
        "collection_1085",
        "collection_1086",
        "collection_1087",
        "collection_1088",
        "collection_1089",
        "collection_1090",
        "collection_1091",
        "collection_1092",
        "collection_1093",
        "collection_1094",
        "collection_1095",
        "collection_1096",
        "collection_1097",
        "collection_1098",
        "collection_1099",
        "collection_1100",
        "collection_1101",
        "collection_1102",
        "collection_1103",
        "collection_1104",
        "collection_1105",
        "collection_1106",
        "collection_1107",
        "collection_1108",
        "collection_1109",
        "collection_1110",
        "collection_1111",
        "collection_1112",
        "collection_1113",
        "collection_1114",
        "collection_1115",
        "collection_1116",
        "collection_1117",
        "collection_1118",
        "collection_1119",
        "collection_1120",
        "collection_1121",
        "collection_1122",
        "collection_1123",
        "collection_1124",
        "collection_1125",
        "collection_1126",
        "collection_1127",
        "collection_1128",
        "collection_1129",
        "collection_1130",
        "collection_1131",
        "collection_1132",
        "collection_1133",
        "collection_1134",
        "collection_1135",
        "collection_1136",
        "collection_1137",
        "collection_1138",
        "collection_1139",
        "collection_1140",
        "collection_1141",
        "collection_1142",
        "collection_1143",
        "collection_1144",
        "collection_1145",
        "collection_1146",
        "collection_1147",
        "collection_1148",
        "collection_1149",
        "collection_1150",
        "collection_1151",
        "collection_1152",
        "collection_1153",
        "collection_1154",
        "collection_1155",
        "collection_1156",
        "collection_1157",
        "collection_1158",
        "collection_1159",
        "collection_1160",
        "collection_1161",
        "collection_1162",
        "collection_1163",
        "collection_1164",
        "collection_1165",
        "collection_1166",
        "collection_1167",
        "collection_1168",
        "collection_1169",
        "collection_1170",
        "collection_1171",
        "collection_1172",
        "collection_1173",
        "collection_1174",
        "collection_1175",
        "collection_1176",
        "collection_1177",
        "collection_1178",
        "collection_1179",
        "collection_1180",
        "collection_1181",
        "collection_1182",
        "collection_1183",
        "collection_1184",
        "collection_1185",
        "collection_1186",
        "collection_1187",
        "collection_1188",
        "collection_1189",
        "collection_1190",
        "collection_1191",
        "collection_1192",
        "collection_1193",
        "collection_1194",
        "collection_1195",
        "collection_1196",
        "collection_1197",
        "collection_1198",
        "collection_1199",
        "collection_1200",
        "collection_1201",
        "collection_1202",
        "collection_1203",
        "collection_1204",
        "collection_1205",
        "collection_1206",
        "collection_1207",
        "collection_1208",
        "collection_1209",
        "collection_1210",
        "collection_1211",
        "collection_1212",
        "collection_1213",
        "collection_1214",
        "collection_1215",
        "collection_1216",
        "collection_1217",
        "collection_1218",
        "collection_1219",
        "collection_1220",
        "collection_1221",
        "collection_1222",
        "collection_1223",
        "collection_1224",
        "collection_1225",
        "collection_1226",
        "collection_1227",
        "collection_1228",
        "collection_1229",
        "collection_1230",
        "collection_1231",
        "collection_1232",
        "collection_1233",
        "collection_1234",
        "collection_1235",
        "collection_1236",
        "collection_1237",
        "collection_1238",
        "collection_1239",
        "collection_1240",
        "collection_1241",
        "collection_1242",
        "collection_1243",
        "collection_1244",
        "collection_1245",
        "collection_1246",
        "collection_1247",
        "collection_1248",
        "collection_1249",
        "collection_1250",
        "collection_1251",
        "collection_1252",
        "collection_1253",
        "collection_1254",
        "collection_1255",
        "collection_1256",
        "collection_1257",
        "collection_1258",
        "collection_1259",
        "collection_1260",
        "collection_1261",
        "collection_1262",
        "collection_1263",
        "collection_1264",
        "collection_1265",
        "collection_1266",
        "collection_1267",
        "collection_1268",
        "collection_1269",
        "collection_1270",
        "collection_1271",
        "collection_1272",
        "collection_1273",
        "collection_1274",
        "collection_1275",
        "collection_1276",
        "collection_1277",
        "collection_1278",
        "collection_1279",
        "collection_1280",
        "collection_1281",
        "collection_1282",
        "collection_1283",
        "collection_1284",
        "collection_1285",
        "collection_1286",
        "collection_1287",
        "collection_1288",
        "collection_1289",
        "collection_1290",
        "collection_1291",
        "collection_1292",
        "collection_1293",
        "collection_1294",
        "collection_1295",
        "collection_1296",
        "collection_1297",
        "collection_1298",
        "collection_1299",
        "collection_1300",
        "collection_1301",
        "collection_1302",
        "collection_1303",
        "collection_1304",
        "collection_1305",
        "collection_1306",
        "collection_1307",
        "collection_1308",
        "collection_1309",
        "collection_1310",
        "collection_1311",
        "collection_1312",
        "collection_1313",
        "collection_1314",
        "collection_1315",
        "collection_1316",
        "collection_1317",
        "collection_1318",
        "collection_1319",
        "collection_1320",
        "collection_1321",
        "collection_1322",
        "collection_1323",
        "collection_1324",
        "collection_1325",
        "collection_1326",
        "collection_1327",
        "collection_1328",
        "collection_1329",
        "collection_1330",
        "collection_1331",
        "collection_1332",
        "collection_1333",
        "collection_1334",
        "collection_1335",
        "collection_1336",
        "collection_1337",
        "collection_1338",
        "collection_1339",
        "collection_1340",
        "collection_1341",
        "collection_1342",
        "collection_1343",
        "collection_1344",
        "collection_1345",
        "collection_1346",
        "collection_1347",
        "collection_1348",
        "collection_1349",
        "collection_1350",
        "collection_1351",
        "collection_1352",
        "collection_1353",
        "collection_1354",
        "collection_1355",
        "collection_1356",
        "collection_1357",
        "collection_1358",
        "collection_1359",
        "collection_1360",
        "collection_1361",
        "collection_1362",
        "collection_1363",
        "collection_1364",
        "collection_1365",
        "collection_1366",
        "collection_1367",
        "collection_1368",
        "collection_1369",
        "collection_1370",
        "collection_1371",
        "collection_1372",
        "collection_1373",
        "collection_1374",
        "collection_1375",
        "collection_1376",
        "collection_1377",
        "collection_1378",
        "collection_1379",
        "collection_1380",
        "collection_1381",
        "collection_1382",
        "collection_1383",
        "collection_1384",
        "collection_1385",
        "collection_1386",
        "collection_1387",
        "collection_1388",
        "collection_1389",
        "collection_1390",
        "collection_1391",
        "collection_1392",
        "collection_1393",
        "collection_1394",
        "collection_1395",
        "collection_1396",
        "collection_1397",
        "collection_1398",
        "collection_1399",
        "collection_1400",
        "collection_1401",
        "collection_1402",
        "collection_1403",
        "collection_1404",
        "collection_1405",
        "collection_1406",
        "collection_1407",
        "collection_1408",
        "collection_1409",
        "collection_1410",
        "collection_1411",
        "collection_1412",
        "collection_1413",
        "collection_1414",
        "collection_1415",
        "collection_1416",
        "collection_1417",
        "collection_1418",
        "collection_1419",
        "collection_1420",
        "collection_1421",
        "collection_1422",
        "collection_1423",
        "collection_1424",
        "collection_1425",
        "collection_1426",
        "collection_1427",
        "collection_1428",
        "collection_1429",
        "collection_1430",
        "collection_1431",
        "collection_1432",
        "collection_1433",
        "collection_1434",
        "collection_1435",
        "collection_1436",
        "collection_1437",
        "collection_1438",
        "collection_1439",
        "collection_1440",
        "collection_1441",
        "collection_1442",
        "collection_1443",
        "collection_1444",
        "collection_1445",
        "collection_1446",
        "collection_1447",
        "collection_1448",
        "collection_1449",
        "collection_1450",
        "collection_1451",
        "collection_1452",
        "collection_1453",
        "collection_1454",
        "collection_1455",
        "collection_1456",
        "collection_1457",
        "collection_1458",
        "collection_1459",
        "collection_1460",
        "collection_1461",
        "collection_1462",
        "collection_1463",
        "collection_1464",
        "collection_1465",
        "collection_1466",
        "collection_1467",
        "collection_1468",
        "collection_1469",
        "collection_1470",
        "collection_1471",
        "collection_1472",
        "collection_1473",
        "collection_1474",
        "collection_1475",
        "collection_1476",
        "collection_1477",
        "collection_1478",
        "collection_1479",
        "collection_1480",
        "collection_1481",
        "collection_1482",
        "collection_1483",
        "collection_1484",
        "collection_1485",
        "collection_1486",
        "collection_1487",
        "collection_1488",
        "collection_1489",
        "collection_1490",
        "collection_1491",
        "collection_1492",
        "collection_1493",
        "collection_1494",
        "collection_1495",
        "collection_1496",
        "collection_1497",
        "collection_1498",
        "collection_1499",
        "collection_1500",
        "collection_1501",
        "collection_1502",
        "collection_1503",
        "collection_1504",
        "collection_1505",
        "collection_1506",
        "collection_1507",
        "collection_1508",
        "collection_1509",
        "collection_1510",
        "collection_1511",
        "collection_1512",
        "collection_1513",
        "collection_1514",
        "collection_1515",
        "collection_1516",
        "collection_1517",
        "collection_1518",
        "collection_1519",
        "collection_1520",
        "collection_1521",
        "collection_1522",
        "collection_1523",
        "collection_1524",
        "collection_1525",
        "collection_1526",
        "collection_1527",
        "collection_1528",
        "collection_1529",
        "collection_1530",
        "collection_1531",
        "collection_1532",
        "collection_1533",
        "collection_1534",
        "collection_1535",
        "collection_1536",
        "collection_1537",
        "collection_1538",
        "collection_1539",
        "collection_1540",
        "collection_1541",
        "collection_1542",
        "collection_1543",
        "collection_1544",
        "collection_1545",
        "collection_1546",
        "collection_1547",
        "collection_1548",
        "collection_1549",
        "collection_1550",
        "collection_1551",
        "collection_1552",
        "collection_1553",
        "collection_1554",
        "collection_1555",
        "collection_1556",
        "collection_1557",
        "collection_1558",
        "collection_1559",
        "collection_1560",
        "collection_1561",
        "collection_1562",
        "collection_1563",
        "collection_1564",
        "collection_1565",
        "collection_1566",
        "collection_1567",
        "collection_1568",
        "collection_1569",
        "collection_1570",
        "collection_1571",
        "collection_1572",
        "collection_1573",
        "collection_1574",
        "collection_1575",
        "collection_1576",
        "collection_1577",
        "collection_1578",
        "collection_1579",
        "collection_1580",
        "collection_1581",
        "collection_1582",
        "collection_1583",
        "collection_1584",
        "collection_1585",
        "collection_1586",
        "collection_1587",
        "collection_1588",
        "collection_1589",
        "collection_1590",
        "collection_1591",
        "collection_1592",
        "collection_1593",
        "collection_1594",
        "collection_1595",
        "collection_1596",
        "collection_1597",
        "collection_1598",
        "collection_1599",
        "collection_1600",
        "collection_1601",
        "collection_1602",
        "collection_1603",
        "collection_1604",
        "collection_1605",
        "collection_1606",
        "collection_1607",
        "collection_1608",
        "collection_1609",
        "collection_1610",
        "collection_1611",
        "collection_1612",
        "collection_1613",
        "collection_1614",
        "collection_1615",
        "collection_1616",
        "collection_1617",
        "collection_1618",
        "collection_1619",
        "collection_1620",
        "collection_1621",
        "collection_1622",
        "collection_1623",
        "collection_1624",
        "collection_1625",
        "collection_1626",
        "collection_1627",
        "collection_1628",
        "collection_1629",
        "collection_1630",
        "collection_1631",
        "collection_1632",
        "collection_1633",
        "collection_1634",
        "collection_1635",
        "collection_1636",
        "collection_1637",
        "collection_1638",
        "collection_1639",
        "collection_1640",
        "collection_1641",
        "collection_1642",
        "collection_1643",
        "collection_1644",
        "collection_1645",
        "collection_1646",
        "collection_1647",
        "collection_1648",
        "collection_1649",
        "collection_1650",
        "collection_1651",
        "collection_1652",
        "collection_1653",
        "collection_1654",
        "collection_1655",
        "collection_1656",
        "collection_1657",
        "collection_1658",
        "collection_1659",
        "collection_1660",
        "collection_1661",
        "collection_1662",
        "collection_1663",
        "collection_1664",
        "collection_1665",
        "collection_1666",
        "collection_1667",
        "collection_1668",
        "collection_1669",
        "collection_1670",
        "collection_1671",
        "collection_1672",
        "collection_1673",
        "collection_1674",
        "collection_1675",
        "collection_1676",
        "collection_1677",
        "collection_1678",
        "collection_1679",
        "collection_1680",
        "collection_1681",
        "collection_1682",
        "collection_1683",
        "collection_1684",
        "collection_1685",
        "collection_1686",
        "collection_1687",
        "collection_1688",
        "collection_1689",
        "collection_1690",
        "collection_1691",
        "collection_1692",
        "collection_1693",
        "collection_1694",
        "collection_1695",
        "collection_1696",
        "collection_1697",
        "collection_1698",
        "collection_1699",
        "collection_1700",
        "collection_1701",
        "collection_1702",
        "collection_1703",
        "collection_1704",
        "collection_1705",
        "collection_1706",
        "collection_1707",
        "collection_1708",
        "collection_1709",
        "collection_1710",
        "collection_1711",
        "collection_1712",
        "collection_1713",
        "collection_1714",
        "collection_1715",
        "collection_1716",
        "collection_1717",
        "collection_1718",
        "collection_1719",
        "collection_1720",
        "collection_1721",
        "collection_1722",
        "collection_1723",
        "collection_1724",
        "collection_1725",
        "collection_1726",
        "collection_1727",
        "collection_1728",
        "collection_1729",
        "collection_1730",
        "collection_1731",
        "collection_1732",
        "collection_1733",
        "collection_1734",
        "collection_1735",
        "collection_1736",
        "collection_1737",
        "collection_1738",
        "collection_1739",
        "collection_1740",
        "collection_1741",
        "collection_1742",
        "collection_1743",
        "collection_1744",
        "collection_1745",
        "collection_1746",
        "collection_1747",
        "collection_1748",
        "collection_1749",
        "collection_1750",
        "collection_1751",
        "collection_1752",
        "collection_1753",
        "collection_1754",
        "collection_1755",
        "collection_1756",
        "collection_1757",
        "collection_1758",
        "collection_1759",
        "collection_1760",
        "collection_1761",
        "collection_1762",
        "collection_1763",
        "collection_1764",
        "collection_1765",
        "collection_1766",
        "collection_1767",
        "collection_1768",
        "collection_1769",
        "collection_1770",
        "collection_1771",
        "collection_1772",
        "collection_1773",
        "collection_1774",
        "collection_1775",
        "collection_1776",
        "collection_1777",
        "collection_1778",
        "collection_1779",
        "collection_1780",
        "collection_1781",
        "collection_1782",
        "collection_1783",
        "collection_1784",
        "collection_1785",
        "collection_1786",
        "collection_1787",
        "collection_1788",
        "collection_1789",
        "collection_1790",
        "collection_1791",
        "collection_1792",
        "collection_1793",
        "collection_1794",
        "collection_1795",
        "collection_1796",
        "collection_1797",
        "collection_1798",
        "collection_1799",
        "collection_1800",
        "collection_1801",
        "collection_1802",
        "collection_1803",
        "collection_1804",
        "collection_1805",
        "collection_1806",
        "collection_1807",
        "collection_1808",
        "collection_1809",
        "collection_1810",
        "collection_1811",
        "collection_1812",
        "collection_1813",
        "collection_1814",
        "collection_1815",
        "collection_1816",
        "collection_1817",
        "collection_1818",
        "collection_1819",
        "collection_1820",
        "collection_1821",
        "collection_1822",
        "collection_1823",
        "collection_1824",
        "collection_1825",
        "collection_1826",
        "collection_1827",
        "collection_1828",
        "collection_1829",
        "collection_1830",
        "collection_1831",
        "collection_1832",
        "collection_1833",
        "collection_1834",
        "collection_1835",
        "collection_1836",
        "collection_1837",
        "collection_1838",
        "collection_1839",
        "collection_1840",
        "collection_1841",
        "collection_1842",
        "collection_1843",
        "collection_1844",
        "collection_1845",
        "collection_1846",
        "collection_1847",
        "collection_1848",
        "collection_1849",
        "collection_1850",
        "collection_1851",
        "collection_1852",
        "collection_1853",
        "collection_1854",
        "collection_1855",
        "collection_1856",
        "collection_1857",
        "collection_1858",
        "collection_1859",
        "collection_1860",
        "collection_1861",
        "collection_1862",
        "collection_1863",
        "collection_1864",
        "collection_1865",
        "collection_1866",
        "collection_1867",
        "collection_1868",
        "collection_1869",
        "collection_1870",
        "collection_1871",
        "collection_1872",
        "collection_1873",
        "collection_1874",
        "collection_1875",
        "collection_1876",
        "collection_1877",
        "collection_1878",
        "collection_1879",
        "collection_1880",
        "collection_1881",
        "collection_1882",
        "collection_1883",
        "collection_1884",
        "collection_1885",
        "collection_1886",
        "collection_1887",
        "collection_1888",
        "collection_1889",
        "collection_1890",
        "collection_1891",
        "collection_1892",
        "collection_1893",
        "collection_1894",
        "collection_1895",
        "collection_1896",
        "collection_1897",
        "collection_1898",
        "collection_1899",
        "collection_1900",
        "collection_1901",
        "collection_1902",
        "collection_1903",
        "collection_1904",
        "collection_1905",
        "collection_1906",
        "collection_1907",
        "collection_1908",
        "collection_1909",
        "collection_1910",
        "collection_1911",
        "collection_1912",
        "collection_1913",
        "collection_1914",
        "collection_1915",
        "collection_1916",
        "collection_1917",
        "collection_1918",
        "collection_1919",
        "collection_1920",
        "collection_1921",
        "collection_1922",
        "collection_1923",
        "collection_1924",
        "collection_1925",
        "collection_1926",
        "collection_1927",
        "collection_1928",
        "collection_1929",
        "collection_1930",
        "collection_1931",
        "collection_1932",
        "collection_1933",
        "collection_1934",
        "collection_1935",
        "collection_1936",
        "collection_1937",
        "collection_1938",
        "collection_1939",
        "collection_1940",
        "collection_1941",
        "collection_1942",
        "collection_1943",
        "collection_1944",
        "collection_1945",
        "collection_1946",
        "collection_1947",
        "collection_1948",
        "collection_1949",
        "collection_1950",
        "collection_1951",
        "collection_1952",
        "collection_1953",
        "collection_1954",
        "collection_1955",
        "collection_1956",
        "collection_1957",
        "collection_1958",
        "collection_1959",
        "collection_1960",
        "collection_1961",
        "collection_1962",
        "collection_1963",
        "collection_1964",
        "collection_1965",
        "collection_1966",
        "collection_1967",
        "collection_1968",
        "collection_1969",
        "collection_1970",
        "collection_1971",
        "collection_1972",
        "collection_1973",
        "collection_1974",
        "collection_1975",
        "collection_1976",
        "collection_1977",
        "collection_1978",
        "collection_1979",
        "collection_1980",
        "collection_1981",
        "collection_1982",
        "collection_1983",
        "collection_1984",
        "collection_1985",
        "collection_1986",
        "collection_1987",
        "collection_1988",
        "collection_1989",
        "collection_1990",
        "collection_1991",
        "collection_1992",
        "collection_1993",
        "collection_1994",
        "collection_1995",
        "collection_1996",
        "collection_1997",
        "collection_1998",
        "collection_1999",
        "collection_2000",
        "collection_2001",
        "collection_2002",
        "collection_2003",
        "collection_2004",
        "collection_2005",
        "collection_2006",
        "collection_2007",
        "collection_2008",
        "collection_2009",
        "collection_2010",
        "collection_2011",
        # "collection_2012",
        # "collection_2013",
        # "collection_2014",
        # "collection_2015",
        # "collection_2016",
        # "collection_2017",
        # "collection_2018",
        # "collection_2019",
        # "collection_2020",
        # "collection_2021",
        # "collection_2022",
        # "collection_2023",
        # "collection_2024",
        # "collection_2025",
        # "collection_2026",
        # "collection_2027",
        # "collection_2028",
        # "collection_2029",
        # "collection_2030",
        # "collection_2031",
        # "collection_2032",
        # "collection_2033",
        # "collection_2034",
        # "collection_2035",
        # "collection_2036",
        # "collection_2037",
        # "collection_2038",
        # "collection_2039",
        # "collection_2040",
        # "collection_2041",
        # "collection_2042",
        # "collection_2043",
        # "collection_2044",
        # "collection_2045",
        # "collection_2046",
        # "collection_2047",
        # "collection_2048",
        # "collection_2049",
        # "collection_2050",
        # "collection_2051",
        # "collection_2052",
        # "collection_2053",
        # "collection_2054",
        # "collection_2055",
        # "collection_2056",
        # "collection_2057",
        # "collection_2058",
        # "collection_2059",
        # "collection_2060",
        # "collection_2061",
        # "collection_2062",
        # "collection_2063",
        # "collection_2064",
        # "collection_2065",
        # "collection_2066",
        # "collection_2067",
        # "collection_2068",
        # "collection_2069",
        # "collection_2070",
        # "collection_2071",
        # "collection_2072",
        # "collection_2073",
        # "collection_2074",
        # "collection_2075",
        # "collection_2076",
        # "collection_2077",
        # "collection_2078",
        # "collection_2079",
        # "collection_2080",
        # "collection_2081",
        # "collection_2082",
        # "collection_2083",
        # "collection_2084",
        # "collection_2085",
        # "collection_2086",
        # "collection_2087",
        # "collection_2088",
        # "collection_2089",
        # "collection_2090",
        # "collection_2091",
        # "collection_2092",
        # "collection_2093",
        # "collection_2094",
        # "collection_2095",
        # "collection_2096",
        # "collection_2097",
        # "collection_2098",
        # "collection_2099",
        # "collection_2100",
        # "collection_2101",
        # "collection_2102",
        # "collection_2103",
        # "collection_2104",
        # "collection_2105",
        # "collection_2106",
        # "collection_2107",
        # "collection_2108",
        # "collection_2109",
        # "collection_2110",
        # "collection_2111",
        # "collection_2112",
        # "collection_2113",
        # "collection_2114",
        # "collection_2115",
        # "collection_2116",
        # "collection_2117",
        # "collection_2118",
        # "collection_2119",
        # "collection_2120",
        # "collection_2121",
        # "collection_2122",
        # "collection_2123",
        # "collection_2124",
        # "collection_2125",
        # "collection_2126",
        # "collection_2127",
        # "collection_2128",
        # "collection_2129",
        # "collection_2130",
        # "collection_2131",
        # "collection_2132",
        # "collection_2133",
        # "collection_2134",
        # "collection_2135",
        # "collection_2136",
        # "collection_2137",
        # "collection_2138",
        # "collection_2139",
        # "collection_2140",
        # "collection_2141",
        # "collection_2142",
        # "collection_2143",
        # "collection_2144",
        # "collection_2145",
        # "collection_2146",
        # "collection_2147",
        # "collection_2148",
        # "collection_2149",
        # "collection_2150",
        # "collection_2151",
        # "collection_2152",
        # "collection_2153",
        # "collection_2154",
        # "collection_2155",
        # "collection_2156",
        # "collection_2157",
        # "collection_2158",
        # "collection_2159",
        # "collection_2160",
        # "collection_2161",
        # "collection_2162",
        # "collection_2163",
        # "collection_2164",
        # "collection_2165",
        # "collection_2166",
        # "collection_2167",
        # "collection_2168",
        # "collection_2169",
        # "collection_2170",
        # "collection_2171",
        # "collection_2172",
        # "collection_2173",
        # "collection_2174",
        # "collection_2175",
        # "collection_2176",
        # "collection_2177",
        # "collection_2178",
        # "collection_2179",
        # "collection_2180",
        # "collection_2181",
        # "collection_2182",
        # "collection_2183",
        # "collection_2184",
        # "collection_2185",
        # "collection_2186",
        # "collection_2187",
        # "collection_2188",
        # "collection_2189",
        # "collection_2190",
        # "collection_2191",
        # "collection_2192",
        # "collection_2193",
        # "collection_2194",
        # "collection_2195",
        # "collection_2196",
        # "collection_2197",
        # "collection_2198",
        # "collection_2199",
        # "collection_2200",
        # "collection_2201",
        # "collection_2202",
        # "collection_2203",
        # "collection_2204",
        # "collection_2205",
        # "collection_2206",
        # "collection_2207",
        # "collection_2208",
        # "collection_2209",
        # "collection_2210",
        # "collection_2211",
        # "collection_2212",
        # "collection_2213",
        # "collection_2214",
        # "collection_2215",
        # "collection_2216",
        # "collection_2217",
        # "collection_2218",
        # "collection_2219",
        # "collection_2220",
        # "collection_2221",
        # "collection_2222",
        # "collection_2223",
        # "collection_2224",
        # "collection_2225",
        # "collection_2226",
        # "collection_2227",
        # "collection_2228",
        # "collection_2229",
        # "collection_2230",
        # "collection_2231",
        # "collection_2232",
        # "collection_2233",
        # "collection_2234",
        # "collection_2235",
        # "collection_2236",
        # "collection_2237",
        # "collection_2238",
        # "collection_2239",
        # "collection_2240",
        # "collection_2241",
        # "collection_2242",
        # "collection_2243",
        # "collection_2244",
        # "collection_2245",
        # "collection_2246",
        # "collection_2247",
        # "collection_2248",
        # "collection_2249",
        # "collection_2250",
        # "collection_2251",
        # "collection_2252",
        # "collection_2253",
        # "collection_2254",
        # "collection_2255",
        # "collection_2256",
        # "collection_2257",
        # "collection_2258",
        # "collection_2259",
        # "collection_2260",
        # "collection_2261",
        # "collection_2262",
        # "collection_2263",
        # "collection_2264",
        # "collection_2265",
        # "collection_2266",
        # "collection_2267",
        # "collection_2268",
        # "collection_2269",
        # "collection_2270",
        # "collection_2271",
        # "collection_2272",
        # "collection_2273",
        # "collection_2274",
        # "collection_2275",
        # "collection_2276",
        # "collection_2277",
        # "collection_2278",
        # "collection_2279",
        # "collection_2280",
        # "collection_2281",
        # "collection_2282",
        # "collection_2283",
        # "collection_2284",
        # "collection_2285",
        # "collection_2286",
        # "collection_2287",
        # "collection_2288",
        # "collection_2289",
        # "collection_2290",
        # "collection_2291",
        # "collection_2292",
        # "collection_2293",
        # "collection_2294",
        # "collection_2295",
        # "collection_2296",
        # "collection_2297",
        # "collection_2298",
        # "collection_2299",
        # "collection_2300",
        # "collection_2301",
        # "collection_2302",
        # "collection_2303",
        # "collection_2304",
        # "collection_2305",
        # "collection_2306",
        # "collection_2307",
        # "collection_2308",
        # "collection_2309",
        # "collection_2310",
        # "collection_2311",
        # "collection_2312",
        # "collection_2313",
        # "collection_2314",
        # "collection_2315",
        # "collection_2316",
        # "collection_2317",
        # "collection_2318",
        # "collection_2319",
        # "collection_2320",
        # "collection_2321"
    ]

    for index,row in df.iterrows():
        if (row['collection_name'] in collectionsDone):
            print("Skipped collection: " + str(row['collection_name']))
            continue

        print("\nCollectionName: "+ str(row['collection_name']))
        # print("URL Not formatted: "+ str(row['retweeted_url']))

        urlLink = treatLinkToSearch(row['retweeted_url'])

        maxEmptyResults = 3
        mode = args['mode']
        
        if mode == 'update':
            print("Update mode")
            endDate = findOldestDate(row['collection_name'])
            if endDate is None:
                print("Old register not found for collection, changing to insert...")
                mode = 'insert'
            else:
                startDate = endDate - timedelta(days=2)
                startDate, endDate = calculateInterval(startDate, endDate)

        if mode == 'insert':
            print("Insert mode")
            posts = getInitialRequest(urlLink)
            qtd_posts = len(posts)
            print("Posts Collected: "+str(qtd_posts))

            if qtd_posts == 1000:
                # search by date parts
                endDate = posts[0]["date"].split(" ")[0] + " 23:59:59"
                startDate = posts[0]["date"].split(" ")[0] + " 00:00:00"
                # format string to datetime
                endDate = datetime.strptime(endDate, '%Y-%m-%d %H:%M:%S')
                startDate = datetime.strptime(startDate, '%Y-%m-%d %H:%M:%S')
            else:
                if qtd_posts == 0:
                    print(row['collection_name']+": with 0 Documents")
                    continue
                print("Inserting %s Documents" % (len(posts)))
                insertDocuments(row['collection_name'], posts, mode)
                continue

        # loop througth dated responses
        emptyLoop = 0
        mode = 'update'

        while True:
            print("\n")
            startDate, endDate = calculateInterval(startDate, endDate)
            posts = getDatedResponse(startDate, endDate, urlLink)
            qtd_posts = len(posts)

            if qtd_posts == 1000:
                print("qtd_posts=1000 splitting data")
                continue
            elif qtd_posts > 0 and qtd_posts < 1000:
                endDate = startDate
                startDate = endDate - timedelta(days=6)
                emptyLoop = 0
            elif qtd_posts == 0:
                endDate = startDate
                startDate = endDate - timedelta(days=6)

                emptyLoop+=1
                print("No posts for this period")

                if emptyLoop >= maxEmptyResults:
                    break

            if qtd_posts > 0:
                #insert in database
                print("Inserting %s Documents" % (len(posts)))
                insertDocuments(row['collection_name'], posts, mode)


def calculateInterval(startDate, endDate):
    interval = endDate - startDate

    minInterval = timedelta(hours=1, minutes=00, seconds=00)
    if interval < minInterval:
        print("Min interval accepted reached")
        exit(0)

    startDate = startDate + (interval/2)
    # print("Interval before: " + str(interval))
    # print("Interval after: " + str(interval/2))
    # Remove milliseconds
    startDate = startDate.replace(microsecond=0)
    endDate = endDate.replace(microsecond=0)
    print(startDate)
    print(endDate)

    return startDate, endDate


def getDatedResponse(startDate, endDate, link):
    url = "https://api.crowdtangle.com/links?token=%s&count=%s&link=%s&endDate=%s&startDate=%s" % (os.getenv('TOKEN'), 1000, link, endDate, startDate)
    print("URL:" + str(url))

    payload={}
    headers = {}

    try:
        freeze()
        response = requests.request("GET", url, headers=headers, data=payload)
        if (response.status_code == 200):
            response = response.json()
            return response['result']['posts']
        
    except Exception as e:
        print("erro na requisicao")
        print(e)


def getInitialRequest(link):
    url = "https://api.crowdtangle.com/links?token=%s&count=%s&link=%s" % (os.getenv('TOKEN'), 1000, link)
    print("URL: " + str(url))

    payload={}
    headers = {}

    try:
        freeze()
        response = requests.request("GET", url, headers=headers, data=payload)
        if (response.status_code == 200):
            response = response.json()
            return response['result']['posts']
        
    except Exception as e:
        print("erro na requisicao")
        print(e)

def treatLinkToSearch(link):
    urlLink = re.match('(.*&)', link)
    if urlLink is None:
        urlLink = link
    else:
        urlLink = urlLink.group(0).replace("&","")

    return urlLink


def freeze():
    print("sleep:"+str(31))
    sleep(31)


def mongodbConnection(collectionName):
    if collectionName == None:
        print("CollectionName Error")
        exit(666)

    client = MongoClient('mongodb://localhost:27017/')
    db = client.crowdtangle
    return db[collectionName]


def getTotalCollection(collectionName):
    collection = mongodbConnection(collectionName)
    return collection.count_documents({})


def findOldestDate(collectionName):
    collection = mongodbConnection(collectionName)
    count = collection.count_documents({})

    try:
        if count > 0:
            oldest = collection.find().sort("date",1).limit(1)
            for old in oldest:
                return datetime.strptime(old['date'], '%Y-%m-%d %H:%M:%S')
        else:
            return None
    except Exception as e:
        print("Oldest date not found for collection")
        return None


def insertDocuments(collectionName, items, action="insert"): # array of jsons [{},{}]
    collection = mongodbConnection(collectionName)
    
    # delete and re-create to avoid duplicates
    if (action == "insert"):
        collection.drop()

    collection.insert_many(items)
    
    # for item in items:
    #     post_id = collection.insert_one(item).inserted_id
    #     print(post_id)

if __name__ == "__main__":
    main()